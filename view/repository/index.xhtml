<h1>#{h @repos.path}</h1>
<div id="repository-about">
  <h2>About</h2>
  <dl>
    <dt>path</dt><dd>#{h @repos.path}</dd>
    <dt>name</dt><dd>#{h @repos.name}</dd>
    <dt>author</dt><dd>#{h @repos.author.name}</dd>
    <dt>parent</dt><dd>#{h @repos.parent ? @repos.parent.path : "no"}</dd>
    <dt>created_at</dt><dd>#{h @repos.created_at}</dd>
  </dl>
</div>

<div id="repository-action">
<h2>Action</h2>
<span class="action embed">Embed</span>
<?r if @session ?><span class="action checkout">Checkout</span><?r end ?>
<?r if @session and not @session.has_repository?(@repos) ?><span class="action fork">Fork</span><?r end ?>
</div>

<h2>Tree</h2>
<table>
  <?r @repos.entities.each{ |e| ?>
  <tr <?r if e.file? ?>class="togglable"<?r end ?>><td>
      <span class="toggle-bar">#{h e.path }</span>
      <?r if e.file? ?><div class="toggle-content"><pre class="source-code" >#{h e.read }</pre></div><?r end ?>
</td></tr>
  <?r } ?>
</table>

<script type="text/javascript">
  $.extend({
    repository: #{@repos.to_hash.to_json}
  });
</script>
